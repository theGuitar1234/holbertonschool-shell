#!/usr/bin/env bash
# 14-dig_the-data

awk 'BEGIN { FS="\"" }
{
  split($1, a, " "); ip = a[1]
  split($3, b, " "); code = b[1]   # <- status is first, size is second

  if (ip ~ /^[0-9.]+$/ && code ~ /^[0-9][0-9][0-9]$/)
    print ip, code
}' apache-access.log \
| sort \
| uniq -c \
| sort -nr \
| awk '{ printf "%7d %s %s\n", $1, $2, $3 }'
